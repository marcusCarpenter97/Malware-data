#!/bin/bash

#shopt -s nullglob  # Guarantees the array is empty if no match. Do I need this?
vms=(Victim2 Victim3 Victim4 Victim5 Victim6 Victim7 Victim8 Victim9 Victim10 Victim11)
samples=(/media/cape/Seagate\ Expansion\ Drive/MALWARE\ VirusShare_00$1/*)

stack_size="${#samples[@]}"
#stack_size=20
sample_idx=0

echo Number of submissions: $stack_size

while true
do
	for vm in "${!vms[@]}";
	do
		echo python3 /opt/CAPEv2/utils/submit.py --machine "${vms[vm]}" "${samples[sample_idx]}"
		python3 /opt/CAPEv2/utils/submit.py --machine "${vms[vm]}" "${samples[sample_idx]}"
		sample_idx=$((sample_idx+1))
		if  [ $sample_idx -ge $stack_size ]
		then
			exit 1
		fi
	done
done
