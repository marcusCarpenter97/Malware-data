import os
import tensorflow as tf

def model_loader(models_dir="checkpoints"):
    """
    Loads Tensorflow models from a directory, and returns a dictionary where
    the keys are the model names.
    """

    model_names = os.listdir(models_dir)

    models = {}

    for model_name in model_names:
        model_path = os.path.join(models_dir, model_name)
        m = tf.keras.models.load_model(model_path)
        models[model_name] = m

    return models

if __name__ == "__main__":

    models = model_loader()

    # Example usage: print tensorflow summmary
    for model_name in models:
        print(model_name)
        print(models[model_name].summary())
